const requrl = ""
$(document).ready(function () {

    $("#submit").click(function (e) {
        e.preventDefault();
        $("#submit").html(`<div class="spinner-border" role="status">
                <span class="sr-only">Loading...</span>
              </div>`);
        var submitButton = document.querySelector('#submit');
        submitButton.disabled = true;
        var formData = new FormData(document.getElementById("upload-form"));
        var file = formData.get('upload');
        console.log(file.size);
        if(file.size==0){
            alert("You have not selected any file.");
            window.location.reload();
            return false;
        }
        if(file.size>500000000){
            alert("The file is too big. Sorry!")
            window.location.reload();
            return false;
        }
        $.ajax({
            type: 'GET',
            url: 'getSignedUrlApi',
            data: {
                name: file.name,
                type: file.type,
                size:file.size
            },
            contentType: 'application/json',
        }).done(function (data) {
            console.log(data);


            $.ajax({
                type: 'PUT',
                url: data.uploadUrl,
                contentType: file.type,
                processData: false,
                data: file
            })
                .done(function () {
                    console.log(data.downloadUrl);
                    $("#whatsapp").on('click',(e)=>{
                        e.preventDefault();
                        console.log(`whatsapp://send?text=${encodeURIComponent(data.downloadUrl)}`);
                        window.open(`whatsapp://send?text=${encodeURIComponent(data.downloadUrl)}`,'_blank');
                    }); 

                    $("#file").html(file.name);
                    var typeNumber = 0;
                    var errorCorrectionLevel = 'L';
                    var qr = qrcode(typeNumber, errorCorrectionLevel);
                    qr.addData(data.downloadUrl);
                    qr.make();
                    // console.log(qr.createImgTag(6,4));
                    $('#qrcode').html(qr.createImgTag(3, 2));
                    $("#input-form").fadeOut();
                    setTimeout(function () {
                        $("#qrcode-container").fadeIn();
                    }, 1000);
                })
                .fail(function (err) {
                    console.log(err);
                    alert('Sorry some error occured. Please try again!');
                });

        }).fail(function (err) {
            alert('Sorry some error occured. Please try again!');
            console.log(err);
        });
    });
});

!function (a) { "use strict"; a('a.js-scroll-trigger[href*="#"]:not([href="#"])').click(function () { if (location.pathname.replace(/^\//, "") == this.pathname.replace(/^\//, "") && location.hostname == this.hostname) { var e = a(this.hash); if ((e = e.length ? e : a("[name=" + this.hash.slice(1) + "]")).length) return a("html, body").animate({ scrollTop: e.offset().top - 70 }, 1e3, "easeInOutExpo"), !1 } }), a(".js-scroll-trigger").click(function () { a(".navbar-collapse").collapse("hide") }), a("body").scrollspy({ target: "#mainNav", offset: 100 }); var e = function () { a("#mainNav").offset().top > 100 ? a("#mainNav").addClass("navbar-shrink") : a("#mainNav").removeClass("navbar-shrink") }; e(), a(window).scroll(e) }(jQuery);